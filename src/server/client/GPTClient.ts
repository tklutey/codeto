import { ChatGPTAPI } from 'chatgpt';

export default class GPTClient {
  private GPTClient: ChatGPTAPI;

  TIMEOUT = 15000;

  constructor() {
    const token =
      'eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0..x_dDHcLUSIJT2UeX.-qefGr2Mj-3gUnuM00nZOssKgLYLpWvwxe2c0Jp9iWPrXVa_dajBQ-0PCXfEMAGpMyuT5AAtahB6I9pbalQYFlUwqGQRyKtcY6naIataIXV017WjS3JKd4jVA9UonruAf_7Kw7MIbMsoSt0UGHheNOg5Ukqp9d21mbzRtRatuoRPBB9DxOFF967uvUXrXaTLTmHE_F5IRTT3GmOl33TplmCCecCwASFlHYtlYYZvYjIKpIC0_M0kRQUjeA79B6se5TKBfsTAcZoAv6LXSbikvtQeGNJ91yP-QS-IX4GkJRoXpslwi4AwDL1rkG8xVl9SlUQnUh_aqS9d5rn4TxvOrxN4i36e3BD-Yz3_q0C1vEEVbmyC3bk44S1NXdsIyxn74uHibUkFH4rE84sNmqcOYS6I762p8xPDH0rBm2OlbXURIaf9OQdUYXdYIKsP0UTmcvW2Ox0mgTD-RHxUR8dLpqRDILlhRCoCPqMJ_3vHCP_o_kwtuXkJMi6fQkTafJyJm3-LAktJ9vOHFxBVfyUogtTScG1d5qaSmTkK_HaLfrEDqHDwZZXcseph_hTRx74Zds9dVOrlX6c0xPezAVVqgqRkD7iEsXQH2Vr01oGX1kvhB1GThzWtfqmrO6jPdLHBDZJF1_kKO1Hv3z28yuzJw9kp0TkjWUqGaYJnx2bwmyNUWMRbWVfyE__3ifzwKxnuja44srLUpZ_UtRGE5ziLg2mLCcs_OqdelXZD6BF-k8cw5PgECaE2WaQjRK0Fv5u3WszjJe9-86efuZ_Twv0lkT37gBpmVPgTE2b9G1MmX6CJiYee2vZuOWQroYdaz7obTKjfcTKRTPzkaM4z16CzMFx-YCdDcHzu8YHN-xp7IR-rKtpiRYTZNC4GROJs1fQA5KTqW5MnSqn3JYL6uxC5__5G8gectb6W8d3OulBabtxEG4uhn3yp6v3D4Cd4LgC1sn_RjbI_6C8sHAu_71ivEOKTCALvptZgZ-35CEwhZ3OhMdfj-utwjOCqAC30UNrlqvo54lojlXUgwYD281aRjtj0eDHFdNQMOKMTSgfCNougDi5mdvl0GC1tiNxwGd1ZyAA6OZpPrrb3AtVvMYemGXfCgd66UWG5opiaQ_DCFBA9aeE-w2Y-RBxX-GtWKc0f_6hTTe1k5Glycl7bnUvBwPYNDGiAFR99QkKqkrfyq26tiU80vNCfj1rHY_3CS99ME8IWJczRKGAMDXV0_4YrVE-SujySKhBvuBvmb4wgnJC64mOyMqYSfF06LsNjpjULbFX6R1m1cFXnjILmMZLLbhfo3YBllwJaN4B7d5hnajRE8ytGe-ZFZreUv1DFSx0txwQWj9HwNnMLEFocoOKbfxUZ1oh5PVm-n2nRWAC4PDQtUy0pNuEdATAyip1GKFbZwdk2jwH7y4663VKjsukxZ2cTvTBK84zqmxGoZMLljteZiVs0j3OIiyn9GCteuhqf6cUjG2w8ApMEaKyj512OBBWoZjPXHuFK-LoXwzEn1foKxDagIwKdKPA12_TJHncOcWZjlKv_Huqm2tQtsRkGaKT0BEJps16ccI_OjG9ECMFzIuA9xHSeWYRgsolb9BEJ-fwn60T4Vdf2S_zwmbYIwpwM5eh0M_qvVU0swCMd8mNLD-i7_rQURigHQV5XEtF64RKhVYIvKHz2t9ECF7y9BeHRXWzut2oBqS90DGue-ymk3ctKcNCWBEebRTQgQSX5fiWaZHyOr7OqMD9hl2anIabPhTtolE-rwM3urd0FLqKSgrVK1byzLajSQ1Gk39H9iWo2uehRBu_OMobYhv-s0Va7ti3N9JVKy7Y8WZ5zM3_zN0DTSXvx7Xk8ua-AOIMvosach5NAmb9oekgSh0vg2s7LZPxM2du9znO_rHJqrGBahwOpzAww0OLJjtYqByRqTXEQNpozBiME3JG_FtdW2j6gJHikpMMB7S4ffJE4SZuvfVt-xHA_X-j2OBUKxGgjwOjYhx0TJA_taEbqicj7Vc8KUSTDEupHmyhpnSDT15mW6Ya5-isRrRKb-ZORe7HcH7bvcaUJgZkgWCRFusYiYpsYT4ZpP45gwvN5w5ZmCquQheisxq4DyFxp-XVhZmOH7kcx_-dC4LflIh6RDrLzSqiH8anU0CmJo9j0rK_KGbzFxRDDFrdihLyJzkDjy44CwSmACmIt4X9370RT6X9O4ljox1o7KplS-z01eJOvpJJB97sIw6yOo1V_1YQRo0KUNHUov2gR92wF6hhjOzwX_iSl_1v-dxCv5IqyXsQGAQjbp9cKmNccQ0jKUTLQgJVFzzJSk94NYPG5wWf95YjtY0FK-MBhB5tVVmqBtuGAlQ.adtknGGyeTwxXbgTbrlk7Q';
    this.GPTClient = new ChatGPTAPI({
      sessionToken: token
    });
  }

  auth = async () => {
    await this.GPTClient.ensureAuth();
    return this.GPTClient;
  };

  getJavaErrorHint = async (error: string) => {
    // send a message and wait for the response
    const response = await this.GPTClient.sendMessage(
      `Provide a hint (in less than 180 characters) as to what is causing the following Java error: ${error}`,
      {
        timeoutMs: this.TIMEOUT
      }
    );

    // response is a markdown-formatted string
    return response;
  };
}
